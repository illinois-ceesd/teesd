<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.12"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>JustKernels: Theory</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen_html_style.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="xpacc_logo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">JustKernels
   &#160;<span id="projectnumber">1.0</span>
   </div>
   <div id="projectbrief">XPACC Multiphysics simluation application</div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.12 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('theory.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Theory </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="navierStokes"></a>
Fluid Dynamics</h1>
<h2><a class="anchor" id="conserve"></a>
Conservation equations</h2>
<p>In fluid domains, the code solves the compressible Navier-Stokes equations in curvilinear coordinates. The basic equations, in a cartesian coordinate space, for the conserved mass density <img class="formulaInl" alt="$\rho$" src="form_14.png"/>, momentum density <img class="formulaInl" alt="$\rho u_i$" src="form_15.png"/>, and total energy density <img class="formulaInl" alt="$\rho E$" src="form_16.png"/> are, in index form with summation convention are given as</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \begin{align} \frac{\partial \rho}{\partial t} + \frac{\partial }{\partial x_j} \rho u_j &amp;= S_\rho \\ \frac{\partial \rho u_i}{\partial t} + \frac{\partial}{\partial x_j}\left(\rho u_i u_j + p\delta_{ij} - \tau_{ij}\right) &amp;= S_{\rho u_i} \\ \frac{\partial \rho E}{\partial t} + \frac{\partial}{\partial x_j}\left(\left\{\rho E + p\right\}u_j + q_j - u_i \tau_{ij}\right) &amp;= S_{\rho E} \end{align} \]" src="form_17.png"/>
</p>
<p>where <img class="formulaInl" alt="$p$" src="form_18.png"/> is the thermodynamic pressure, <img class="formulaInl" alt="$\tau_{ij}$" src="form_19.png"/> is the viscous stress tensor, and <img class="formulaInl" alt="$q_i$" src="form_20.png"/> is the heat flux in the <img class="formulaInl" alt="$i$" src="form_21.png"/>th direction. <img class="formulaInl" alt="$S_\rho$" src="form_22.png"/>, <img class="formulaInl" alt="$S_{\rho u_i}$" src="form_23.png"/>, and <img class="formulaInl" alt="$S_{\rho E}$" src="form_24.png"/> are are mass, momentum, and energy density source terms. These equations can be written in the compact form</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \frac{\partial Q}{\partial t} + \frac{\partial \vec{F}_j}{\partial x_j} = S \]" src="form_25.png"/>
</p>
<p>where <img class="formulaInl" alt="$Q = [\rho\,\rho \vec{u}\,\rho E]^T$" src="form_26.png"/> is the vector of conserved variables, <img class="formulaInl" alt="$\vec{F} = \vec{F}^I - \vec{F}^V$" src="form_27.png"/> is the flux vector account for both visicd and invisci terms, and <img class="formulaInl" alt="$S$" src="form_28.png"/> is the source term vector. The so-called <em>RHS</em> <img class="formulaInl" alt="$ = S - \frac{\partial}{\partial x_j}\vec{F}_j$" src="form_29.png"/> is evaluated by the top-level RHS driver function in include/NavierStokesRHS.H.</p>
<h2><a class="anchor" id="viscous"></a>
Viscous stress constitutive relation</h2>
<p>The viscous stress tensor is defined as</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \tau_{ij} = \mu \left(\frac{\partial u_i}{\partial x_j} + \frac{\partial u_j}{\partial x_i}\right) + \lambda \frac{\partial u_k}{\partial x_k}\delta_{ij} \]" src="form_30.png"/>
</p>
<p>where <img class="formulaInl" alt="$\mu$" src="form_31.png"/> and <img class="formulaInl" alt="$\lambda$" src="form_32.png"/> are the first and second coefficients of viscosity, respectively; both may be a function of temperature. Note that Stokes' hypothesis <img class="formulaInl" alt="$(\lambda = -\frac{2}{3}\mu)$" src="form_33.png"/> is <em>not</em> automatically enforced and that <img class="formulaInl" alt="$\lambda$" src="form_32.png"/> is related to bulk viscosity <img class="formulaInl" alt="$\mu_B$" src="form_34.png"/> as <img class="formulaInl" alt="$\lambda = \mu_B - (2/3)\mu$" src="form_35.png"/>.</p>
<p><img class="formulaInl" alt="$\tau_{ij}$" src="form_19.png"/> is computed by ComputeTauBuffer in src/ViscidUtil.C.</p>
<h2><a class="anchor" id="heat"></a>
Heat flux constitutive relation</h2>
<p>The heat flux vector is defined as</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ q_i = - \kappa \frac{\partial T}{\partial x_i} \]" src="form_36.png"/>
</p>
<p>where <img class="formulaInl" alt="$\kappa$" src="form_37.png"/> is the thermal conductivity. The heat flux vector, <img class="formulaInl" alt="$q_i$" src="form_20.png"/>, is computed by ComputeHeatFluxBuffer in src/ViscidUtil.C.</p>
<h1><a class="anchor" id="trans"></a>
Transport Coefficient Models</h1>
<p>The first viscosity coefficient <img class="formulaInl" alt="$\mu$" src="form_31.png"/>, bulk viscosity coefficient, <img class="formulaInl" alt="$\mu_B$" src="form_34.png"/>, and the thermal conductivity <img class="formulaInl" alt="$k$" src="form_38.png"/> depend on the thermodynamic state of the fluid. Currently, only one implementation is available, although others can be easily implemented in ViscidUtil.C.</p>
<h2><a class="anchor" id="transModelPower"></a>
Power Law</h2>
<p>The Power Law transport model in implemented in ComputeTVBufferPower.</p>
<p>The power law model gives the dynamic viscosity, <img class="formulaInl" alt="$\mu$" src="form_31.png"/> as</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \mu = \beta T^n \]" src="form_39.png"/>
</p>
<p>where <img class="formulaInl" alt="$\beta$" src="form_40.png"/> and <img class="formulaInl" alt="$n$" src="form_41.png"/> are user specified parameters, typically <img class="formulaInl" alt="$n = 0.666$" src="form_42.png"/> and <img class="formulaInl" alt="$\beta = 4.093 x 10^{-7}$" src="form_43.png"/> for air.</p>
<p>The bulk viscosity is defined as</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \mu_B = \alpha \mu \]" src="form_44.png"/>
</p>
<p>where <img class="formulaInl" alt="$\alpha$" src="form_45.png"/> is a user specified parameter, typically <img class="formulaInl" alt="$\alpha = 0.6$" src="form_46.png"/> for air.</p>
<p>Thus the second coefficient of viscosity can be calculated as</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \lambda = \left(\alpha - 2/3\right) \mu \]" src="form_47.png"/>
</p>
<p>The power law model calculates the :w</p>
<h1><a class="anchor" id="eos"></a>
Equations of state</h1>
<p>The equations of state provides closure by relating the intensive state variables, pressure and temperature, to the extensive state variables, specific internal energy and volume. Currently, only one implementation is available, although others can be easily implemented in EulerUtil.C.</p>
<h2><a class="anchor" id="calIdealGas"></a>
Calorically perfect ideal gas</h2>
<p>The equation of state currently available is that of an ideal gas, assuming constant specific heats. The equations of state are</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ P = \rho R T \]" src="form_48.png"/>
</p>
<p>where <img class="formulaInl" alt="$R$" src="form_49.png"/> is the specific gas constant, defined as <img class="formulaInl" alt="$R = R_u / W$" src="form_50.png"/> with <img class="formulaInl" alt="$R_u$" src="form_51.png"/> the universal gas constant, and <img class="formulaInl" alt="$W$" src="form_52.png"/> the molecular weight.</p>
<p>The specific heat capacity at constant volume and pressure are defined as</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \begin{align} C_v &amp;= \left(\frac{\partial E}{\partial T}\right)_v \\ C_p &amp;= \left(\frac{\partial H}{\partial T}\right)_p \end{align} \]" src="form_53.png"/>
</p>
<p>Then, by substitution into the equation of state we get the following relation</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ R = C_p - C_v \]" src="form_54.png"/>
</p>
<p>By defining the specific heat ratio, <img class="formulaInl" alt="$\gamma = \frac{C_p}{C_v}$" src="form_55.png"/>, the following expressions give the realtionship between specific energy, pressure, and temperature as implemented by ComputeDVBufferIdeal.</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \begin{align} P &amp;= (\gamma -1) \rho e \\ T &amp;= \frac{\gamma-1}{R} e \end{align} \]" src="form_56.png"/>
</p>
<h1><a class="anchor" id="nondimen"></a>
Non-dimensionalization</h1>
<p><em>PlasCom2</em> can run in either a dimensional or non-dimensional mode. The code uses the following variables to define the non-dimensional scaling:</p>
<p><img class="formulaInl" alt="$\rho^*_\infty$" src="form_57.png"/>, <img class="formulaInl" alt="$P^*_\infty$" src="form_58.png"/>, <img class="formulaInl" alt="$T^*_\infty$" src="form_59.png"/>, and <img class="formulaInl" alt="$L^*$" src="form_60.png"/>, a length scale. Where <img class="formulaInl" alt="$*$" src="form_61.png"/> denotes a dimensional value and <img class="formulaInl" alt="$\infty$" src="form_62.png"/> denotes the reference state. There are two optional non-dimensional spaces available to the user, as shown in the table below.</p>
<a class="anchor" id="multi_row"></a>
<table class="doxtable">
<caption>PlasCom2 Non-Dimensional spaces</caption>
<tr>
<th>Standard (nonDimensional=1) </th><th>Legacy PlasComCM (nonDimensional=2) </th></tr>
<tr>
<td><img class="formulaInl" alt="$ u^*_\infty = \sqrt \frac{P^*_\infty}{\rho^*_\infty} $" src="form_63.png"/> </td><td><img class="formulaInl" alt="$ u^*_\infty = \sqrt \frac{\gamma P^*_\infty}{\rho^*_\infty} $" src="form_64.png"/> </td></tr>
<tr>
<td><img class="formulaInl" alt="$ e^*_\infty = u^*_\infty^2 = \frac{P^*_\infty}{\rho^*_\infty} $" src="form_65.png"/> </td><td><img class="formulaInl" alt="$ e^*_\infty = u^*_\infty^2 = \frac{\gamma P^*_\infty}{\rho^*_\infty} $" src="form_66.png"/> </td></tr>
<tr>
<td><img class="formulaInl" alt="$ \rho = \rho^* /\rho^*_\infty $" src="form_67.png"/> </td><td><img class="formulaInl" alt="$ \rho = \rho^* /\rho^*_\infty $" src="form_67.png"/> </td></tr>
<tr>
<td><img class="formulaInl" alt="$ P = P^* /P^*_\infty $" src="form_68.png"/> </td><td><img class="formulaInl" alt="$ P = P^* /(\rho^*_\infty u^*_\infty^2) $" src="form_69.png"/> </td></tr>
<tr>
<td><img class="formulaInl" alt="$ T = T^* /T^*_\infty $" src="form_70.png"/> </td><td><img class="formulaInl" alt="$ T = T^* /((\gamma-1)T^*_\infty) $" src="form_71.png"/> </td></tr>
<tr>
<td><img class="formulaInl" alt="$ u_i = u^*_i /u^*_\infty $" src="form_72.png"/> </td><td><img class="formulaInl" alt="$ u_i = u^*_i /u^*_\infty $" src="form_72.png"/> </td></tr>
<tr>
<td><img class="formulaInl" alt="$ e = e^* /e^*_\infty $" src="form_73.png"/> </td><td><img class="formulaInl" alt="$ e = e^* /e^*_\infty $" src="form_73.png"/> </td></tr>
<tr>
<td><img class="formulaInl" alt="$ t = t^* /(L^* / u^*_\infty) $" src="form_74.png"/> </td><td><img class="formulaInl" alt="$ t = t^* /(L^* / u^*_\infty) $" src="form_74.png"/> </td></tr>
<tr>
<td><img class="formulaInl" alt="$ x_i = x_i^* /L^* $" src="form_75.png"/> </td><td><p class="starttd"><img class="formulaInl" alt="$ x_i = x_i^* /L^* $" src="form_75.png"/></p>
<p class="endtd"></p>
</td></tr>
</table>
<p>Substitution into the dimensional form of the Navier-Stokes equations yields the non-dimensional equivalent</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \begin{align} \frac{\partial \rho}{\partial t} + \frac{\partial }{\partial x_j} \rho u_j &amp;= S_\rho \\ \frac{\partial \rho u_i}{\partial t} + \frac{\partial}{\partial x_j}\left(\rho u_i u_j + p\delta_{ij} - \tau_{ij}\right) &amp;= S_{\rho u_i} \\ \frac{\partial \rho E}{\partial t} + \frac{\partial}{\partial x_j}\left(\left\{\rho E + p\right\}u_j + q_j - u_i \tau_{ij}\right) &amp;= S_{\rho E} \end{align} \]" src="form_17.png"/>
</p>
<p>with the following non-dimensionalization for the source terms</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[\begin{align} S_\rho &amp;= \frac{S^*_\rho L^*}{\rho^*_\infty U^*_\infty} \\ S_{\rho u_i} &amp;= \frac{S^*_{\rho u_i } L^*}{\rho^*_\infty U^*_\infty^2 } \\ S_{\rho E} &amp;= \frac{S^*_{\rho E} L^*}{\rho^*_\infty U^*_\infty^3} \end{align} \]" src="form_76.png"/>
</p>
<p>by choosing the following non-dimensionalizations for the transport coefficients</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[\begin{align} \mu &amp;= \mu^* /\mu^*_\infty \\ \lambda &amp;= \lambda^* /\lambda^*_\infty \\ \kappa &amp;= \kappa^* /\kappa^*_\infty \\ \end{align} \]" src="form_77.png"/>
</p>
<p>the non-dimensional viscous stress tensor and heat flux vector can be written as</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[\begin{align} \tau_{ij} &amp;= \frac{\mu}{\RE} \left(\frac{\partial u_i}{\partial x_j} + \frac{\partial u_j}{\partial x_i}\right) + \frac{\lambda}{\RE} \frac{\partial u_k}{\partial x_k}\delta_{ij} \\ q_i &amp;= - \frac{\mu}{\RE \Pr} \frac{\partial T}{\partial x_i} \end{align} \]" src="form_78.png"/>
</p>
<p>where <img class="formulaInl" alt="$\ensuremath{\mathit{Re}}$" src="form_1.png"/> is defined as the code Reynolds number, <img class="formulaInl" alt="$\RE = \frac{\rho^*_\infty U^*_\infty L^*}{\mu^*_\infty}$" src="form_79.png"/> and <img class="formulaInl" alt="$\ensuremath{\mathit{Pr}}$" src="form_80.png"/> is defined as the Prandtl number, <img class="formulaInl" alt="$\PR = \frac{C^*_p_\infty\mu^*_\infty}{k^*_\infty} = \frac{C_p\mu}{k}$" src="form_81.png"/> which define the dimensional reference values <img class="formulaInl" alt="$\mu^*_\infty$" src="form_82.png"/> and <img class="formulaInl" alt="$\kappa^*_\infty$" src="form_83.png"/> respectively.</p>
<h2><a class="anchor" id="nonDimenEOS"></a>
Non-dimensional equation of state</h2>
<p>There are no special modifications to the calorically perfect gas equation of state, with the exception of the specific gas constant. The reference gas constant is calculated and non-dimensionalized as follows</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[\begin{align} R^*_\infty &amp;= \frac{P^*_\infty}{\rho^*_\infty T^*_\infty} \\ R &amp;= R^* /R^*_\infty \\ \end{align} \]" src="form_84.png"/>
</p>
<p>For the standard non-dimensionalization, <img class="formulaInl" alt="$R$" src="form_49.png"/> is exactly 1.0. For the legacy non-dimensionalization, <img class="formulaInl" alt="$R = \frac{\gamma-1}{\gamma}$" src="form_85.png"/>.</p>
<h1><a class="anchor" id="gridMetrics"></a>
Curvilinear coordinate systems</h1>
<p>It is possible to express the Navier-Stokes equations in any other coordinate system <img class="formulaInl" alt="$\xi_i$" src="form_86.png"/> provided the mapping <img class="formulaInl" alt="$\Xi$" src="form_87.png"/> from <img class="formulaInl" alt="$x_i$" src="form_88.png"/> to <img class="formulaInl" alt="$\xi_i$" src="form_86.png"/> is given. The Cartesian coordinates <img class="formulaInl" alt="$(\vec{x},t)$" src="form_89.png"/> can be mapped to another coordinate system <img class="formulaInl" alt="$(\vec{\xi},\tau)$" src="form_90.png"/> via the time-dependent mappings</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \vec{x} = {X}(\vec{\xi},\tau) \qquad \mbox{ with inverse } \qquad \vec{\xi} = \Xi(\vec{x},t) \]" src="form_91.png"/>
</p>
<p>where <img class="formulaInl" alt="$X^{-1} = \Xi$" src="form_92.png"/> and we only consider non-singular mappings such that <img class="formulaInl" alt="$X^{-1}$" src="form_93.png"/> exists and is well defined. Moreover we take <img class="formulaInl" alt="$t = \tau$" src="form_94.png"/>. The Jacobian of the transformation is defined as <img class="formulaInl" alt="$J = \mathrm{det}(\partial \Xi_i/\partial x_j)$" src="form_95.png"/> and is strictly positive.</p>
<p>Under these conditions and with simple application of the chain rule it can be shown<a class="el" href="citelist.html#CITEREF_vinokur:1974">[11]</a> that the vector (compact) form tranforms to</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \frac{\partial}{\partial \tau}\left(\frac{Q}{J}\right) + \frac{\partial \hat{\vec{F}}^I_i}{\partial \xi_i} - \frac{\partial \hat{\vec{F}}^V_i}{\partial \xi_i}= \frac{S}{J} \]" src="form_96.png"/>
</p>
<p>after using the identities</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \begin{split} \frac{\partial}{\partial \xi_j}\left(\frac{1}{J}\frac{\partial \xi_j}{\partial x_i}\right) &amp;= 0 \qquad \mbox{ for $i = 1, \dots, N$} \\ \frac{\partial}{\partial \tau}\left(\frac{1}{J}\right) + \frac{\partial}{\partial \xi_j}\left(\frac{1}{J}\frac{\partial \xi_j}{\partial t}\right) &amp;= 0, \end{split} \]" src="form_97.png"/>
</p>
<p>where <img class="formulaInl" alt="$N$" src="form_98.png"/> is the number of dimensions. If we define the weighted metric <img class="formulaInl" alt="$\hat{\xi_i} = J^{-1}(\partial \xi/\partial x_i)$" src="form_99.png"/> and contravariant velocity <img class="formulaInl" alt="$\hat{U} = u_j \hat{\xi}_j + \hat{\xi}_t$" src="form_100.png"/>, with similar expressions for the remaining components, then the inviscid fluxes <img class="formulaInl" alt="$\hat{F}^I_i$" src="form_101.png"/> are</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \hat{\vec{F}}^I_1 = \begin{bmatrix} \rho \hat{U} \\ \rho u \hat{U} + p\hat{\xi}_x \\ \rho v \hat{U} + p \hat{\xi}_y \\ (\rho E + p)\hat{U} - \hat{\xi}_t p \end{bmatrix}\qquad \mbox{ and } \qquad \hat{\vec{F}}^I_2 = \begin{bmatrix} \rho \hat{V} \\ \rho u \hat{V} + p\hat{\eta}_x \\ \rho v \hat{V} + p \hat{\eta}_y \\ (\rho E + p)\hat{V} - \hat{\eta}_t p \end{bmatrix} \]" src="form_102.png"/>
</p>
<p>in two dimensions and</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \hat{\vec{F}}^I_1 = \begin{bmatrix} \rho \hat{U} \\ \rho u \hat{U} + p\hat{\xi}_x \\ \rho v \hat{U} + p \hat{\xi}_y \\ \rho w \hat{U} + p\hat{\xi}_z \\ (\rho E + p)\hat{U} - \hat{\xi}_t p \end{bmatrix}, \quad \hat{\vec{F}}^I_2 = \begin{bmatrix} \rho \hat{V} \\ \rho u \hat{V} + p\hat{\eta}_x \\ \rho v \hat{V} + p \hat{\eta}_y \\ \rho w \hat{V} + p \hat{\eta}_z \\ (\rho E + p)\hat{V} - \hat{\eta}_t p \end{bmatrix}, \quad \mbox{and} \quad \hat{\vec{F}}^I_3 = \begin{bmatrix} \rho \hat{W} \\ \rho u \hat{W} + p\hat{\zeta}_x \\ \rho w \hat{W} + p \hat{\zeta}_y \\ \rho w \hat{W} + p \hat{\zeta}_z \\ (\rho E + p)\hat{W} - \hat{\zeta}_t p \end{bmatrix} \]" src="form_103.png"/>
</p>
<p>The inviscid fluxes are computed dimension-at-a-time by <a class="el" href="namespaceeuler.html#a75d1a7e992d0b046ee381c90d22d4c44">Euler::Flux1D</a> in <a class="el" href="Euler_8f90.html">kernels/Euler.f90</a>.</p>
<h2><a class="anchor" id="viscousForms"></a>
Forms of the viscous terms</h2>
<p>The viscous fluxes may be expressed in a number of forms, depending on the particular goal. The main difference between the particular forms is how second derivatives are taken; namely, either <img class="formulaInl" alt="$\partial^2/\partial x^2$" src="form_104.png"/> is taken directly or as two repeated derivatives, <img class="formulaInl" alt="$\partial/\partial x\left(\partial/\partial x\right)$" src="form_105.png"/>. The use of <img class="formulaInl" alt="$\partial^2/\partial x^2$" src="form_104.png"/> is advantageous in that it allows for the most physical dissipation in the code, as determined by the modified wavenumber. (See, <em>e.g</em>., Lele<a class="el" href="citelist.html#CITEREF_lele:1992">[6]</a> for a discussion of the modified wavenumber and its meaning.) However, it is also expensive, especially in three or more dimensions. Using repeated derivatives in advantageous for two reasons: (i) it keeps the equations in <em>conservative form</em> which is useful for shock capturing and (ii) it is less expensive (by a factor around 2.5 in three dimensions) than the fully expanded form. However, it provides less physical dissipation, especially at the highest wavenumbers, exactly where it is most needed.</p>
<h3><a class="anchor" id="strongVisc"></a>
Strong form of the viscous terms in xi-coordinates</h3>
<p>Following Anderson, Tanehill, and Pletcher (1984), the strong form of the viscous terms is as follows</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \begin{align} \frac{\partial}{\partial t}\left(\frac{\rho u_1}{J}\right) &amp;= \cdots \frac{\partial}{\partial \xi}\left(\hat{\xi}_i\tau_{i1}\right) + \frac{\partial}{\partial \eta}\left(\hat{\eta}_i\tau_{i1}\right) + \frac{\partial}{\partial \zeta}\left(\hat{\zeta}_i\tau_{i1}\right) \\ \frac{\partial}{\partial t}\left(\frac{\rho u_2}{J}\right) &amp;= \cdots \frac{\partial}{\partial \xi}\left(\hat{\xi}_i\tau_{i2}\right) + \frac{\partial}{\partial \eta}\left(\hat{\eta}_i\tau_{i2}\right) + \frac{\partial}{\partial \zeta}\left(\hat{\zeta}_i\tau_{i2}\right) \\ \frac{\partial}{\partial t}\left(\frac{\rho u_3}{J}\right) &amp;= \cdots \frac{\partial}{\partial \xi}\left(\hat{\xi}_i\tau_{i3}\right) + \frac{\partial}{\partial \eta}\left(\hat{\eta}_i\tau_{i3}\right) + \frac{\partial}{\partial \zeta}\left(\hat{\zeta}_i\tau_{i3}\right) \\ \frac{\partial}{\partial t}\left(\frac{\rho E}{J}\right) &amp;= \cdots \frac{\partial}{\partial \xi}\left(\hat{\xi}_i [ u_j \tau_{ij} - q_i ]\right) + \frac{\partial}{\partial \eta}\left(\hat{\eta}_i [ u_j \tau_{ij} - q_i ]\right) + \frac{\partial}{\partial \zeta}\left(\hat{\zeta}_i [ u_j \tau_{ij} - q_i ]\right) \end{align} \]" src="form_106.png"/>
</p>
<p>This form is much faster than the other forms, but does not have any dissipation at the highest wavenumbers. The viscous flux components are computed dimension-at-a-time by <a class="el" href="namespaceviscid.html#aa370fc5ec33429588facc68ee01d8435">Viscid::StrongFlux1D</a> in <a class="el" href="Viscid_8f90.html">kernels/Viscid.f90</a>.</p>
<p>Selected by the user with <code>METRICTYPE = NONORTHOGONAL_STRONGFORM</code> in . </p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Fri Apr 10 2020 12:24:30 for JustKernels by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.12 </li>
  </ul>
</div>
</body>
</html>
