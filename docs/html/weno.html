<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.12"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>JustKernels: WENO</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen_html_style.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="xpacc_logo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">JustKernels
   &#160;<span id="projectnumber">1.0</span>
   </div>
   <div id="projectbrief">XPACC Multiphysics simluation application</div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.12 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('weno.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">WENO </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>This document summarizes the WENO scheme implementation in PlasCom2.</p>
<p>The fifth-order finite difference WENO scheme of Jiang and Shu <a class="el" href="citelist.html#CITEREF_Jiang1996:fifth">[2]</a> with modifications for the freestream preservation on curvilinear grids <a class="el" href="citelist.html#CITEREF_nonomura2015new">[8]</a> are considered. A reduced-order platform is applied to reduce the order of the scheme close to the boundaries and the characteristic wave relations are used for the points on the boundary to implement different boundaries, such as inflow, outflow, no-slip adiabatic and slip isothermal walls.</p>
<h1><a class="anchor" id="gov"></a>
Euler equations</h1>
<p>Euler equations in the computational space in the vector form are considered </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \begin{equation*} \frac{\partial \hat{\mathbf{Q}}}{\partial t}+\frac{\partial \hat{\mathbf{E}}}{\partial \xi}+\frac{\partial \hat{\mathbf{F}}}{\partial \eta}+\frac{\partial \hat{\mathbf{G}}}{\partial \zeta}=\hat{\mathbf{S_V}}, \end{equation*} \]" src="form_107.png"/>
</p>
<p> where </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \begin{equation*} \hat{\mathbf{Q}}=\frac{\mathbf{Q}}{J}, \quad \hat{\mathbf{E}}=\frac{\xi_x \mathbf{E} +\xi_y \mathbf{F} +\xi_z \mathbf{G}}{J}, \quad \hat{\mathbf{F}}=\frac{\eta_x \mathbf{E}+\eta_y \mathbf{F} +\eta_z \mathbf{G}}{J},\quad \hat{\mathbf{G}}=\frac{\zeta_x \mathbf{E}+\zeta_y \mathbf{F} +\zeta_z \mathbf{G}}{J}, \quad \hat{\mathbf{S_V}}=\frac{\mathbf{S_V}}{J}. \end{equation*} \]" src="form_108.png"/>
</p>
<p> In this formulation, the Cartesian coordinates are mapped to a time-dependent coordinate system <img class="formulaInl" alt="$(\xi, \tau)$" src="form_109.png"/>, and <img class="formulaInl" alt="$J$" src="form_110.png"/> is the Jacobian of the transformation. <img class="formulaInl" alt="$\mathbf{Q}$" src="form_111.png"/> is the vector of conserved variables, <img class="formulaInl" alt="$\mathbf{S_V}$" src="form_112.png"/> is the source term, and <img class="formulaInl" alt="$\mathbf{E}$" src="form_113.png"/>, <img class="formulaInl" alt="$\mathbf{F}$" src="form_114.png"/>, and <img class="formulaInl" alt="$\mathbf{G}$" src="form_115.png"/> are the flux vectors in the <img class="formulaInl" alt="$x$" src="form_116.png"/>, <img class="formulaInl" alt="$y$" src="form_117.png"/>, and <img class="formulaInl" alt="$z$" src="form_118.png"/> directions, respectively.</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \begin{equation*} \mathbf{Q}= \begin{bmatrix} \rho \\ \rho u \\ \rho v \\ \rho w \\ E \end{bmatrix}, \qquad \mathbf{E}= \begin{bmatrix} \rho u \\ \rho u^2+p \\ \rho uv \\ \rho uw \\ u(\rho e+p) \end{bmatrix}, \qquad \mathbf{F}= \begin{bmatrix} \rho v \\ \rho uv \\ \rho v^2+p \\ \rho vw \\ v(\rho e+p) \end{bmatrix}, \qquad \mathbf{G}= \begin{bmatrix} \rho u \\ \rho uw \\ \rho vw \\ \rho w^2+p \\ w(\rho e+p) \end{bmatrix}, \end{equation*} \]" src="form_119.png"/>
</p>
<p> where <img class="formulaInl" alt="$\rho$" src="form_14.png"/> is density, <img class="formulaInl" alt="$u$" src="form_120.png"/>, <img class="formulaInl" alt="$v$" src="form_121.png"/>, and <img class="formulaInl" alt="$w$" src="form_122.png"/> are the velocities, <img class="formulaInl" alt="$p$" src="form_18.png"/> is the pressure, <img class="formulaInl" alt="$e$" src="form_123.png"/> is the internal energy, and <img class="formulaInl" alt="$E$" src="form_124.png"/> is the total energy.</p>
<h1><a class="anchor" id="numerics"></a>
Finite difference WENO</h1>
<p>For a finite difference scheme, the flux derivative is </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \begin{equation*} \frac{\partial \hat{\mathbf{F}}}{\partial \eta}\bigg\rvert_{i}=\frac{ \hat{\mathbf{F}}_{i+\frac{1}{2}}-\hat{\mathbf{F}}_{i-\frac{1}{2}}}{\Delta \eta}, \end{equation*} \]" src="form_125.png"/>
</p>
<p> and the goal is to calculate the fluxes at cell edges, while the conserved variables are stored at the center of each cell. The WENO procedure to obtain the numerical flux <img class="formulaInl" alt="$\hat{\mathbf{F}}_{i+\frac{1}{2}}$" src="form_126.png"/> is <a class="el" href="citelist.html#CITEREF_Jiang1996:fifth">[2]</a> <a class="el" href="citelist.html#CITEREF_Jiang1999:mhd">[4]</a> <a class="el" href="citelist.html#CITEREF_Christlieb2014:mhd">[1]</a> :  Compute the physical flux at each grid point: </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \begin{align*} \hat{\mathbf{F}}_{i} = \hat{\mathbf{F}}(\mathbf{Q}_{i}), \end{align*} \]" src="form_127.png"/>
</p>
<p>At each <img class="formulaInl" alt="$\eta_{i+\frac{1}{2}}$" src="form_128.png"/>, compute the left and right eigenvectors based on the Roe average between <img class="formulaInl" alt="$\eta_i$" src="form_129.png"/> and <img class="formulaInl" alt="$\eta_{i+1}$" src="form_130.png"/>.</p>
<p>Project the flux vector and the vector of conserved variables into the characteristic space: </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \begin{align*} \tilde{\mathbf{Q}}_{j} &amp;= \mathbf{L}_{i+\frac{1}{2}}\mathbf{Q}_{j} \text{{} and }\tilde{\mathbf{F}}_{j} = \mathbf{L}_{i+\frac{1}{2}}\mathbf{F}_{j}, \end{align*} \]" src="form_131.png"/>
</p>
<p> for all points in the numerical stencil associated with <img class="formulaInl" alt="$\eta_{i+\frac{1}{2}}$" src="form_128.png"/>, i.e, <img class="formulaInl" alt="$\eta = i-2, i-1, i, i+1, i+2, i+3$" src="form_132.png"/>.  Perform a Lax-Friedrichs flux vector splitting for each component of the characteristic variables. Specifically, assume that the <img class="formulaInl" alt="$s$" src="form_133.png"/>th component of <img class="formulaInl" alt="$\tilde{\mathbf{Q}}_{j}$" src="form_134.png"/> and <img class="formulaInl" alt="$\tilde{\mathbf{F}}_{j}$" src="form_135.png"/> are <img class="formulaInl" alt="$\tilde{Q}_{j,s}$" src="form_136.png"/> and <img class="formulaInl" alt="$\tilde{F}_{j,s}$" src="form_137.png"/>, respectively, then compute </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \begin{align*} \tilde{F}_{j,s}^{\pm} =\frac{1}{2}(\tilde{F}_{j,s}\pm\alpha_{s}\tilde{Q}_{j,s}), \end{align*} \]" src="form_138.png"/>
</p>
<p> where </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \begin{align*}\label{eq:alpha} \alpha_{s} = \kappa \underset{k}\max \lvert \lambda_{s}(\vec{Q}_{k})\rvert, \end{align*} \]" src="form_139.png"/>
</p>
<p> is the maximal wave speed of the <img class="formulaInl" alt="$s$" src="form_133.png"/>th component of the characteristic variables over <img class="formulaInl" alt="$i-2 \le k \le i+3$" src="form_140.png"/>, and <img class="formulaInl" alt="$\lambda_{s}$" src="form_141.png"/> is the <img class="formulaInl" alt="$s$" src="form_133.png"/>th eigenvalue in the diagonal matrix <img class="formulaInl" alt="$\mathbf{\Lambda}$" src="form_142.png"/>, and <img class="formulaInl" alt="$\kappa=1.1$" src="form_143.png"/> <a class="el" href="citelist.html#CITEREF_Jiang1996:fifth">[2]</a>.</p>
<p>Perform a WENO reconstruction on each of the computed flux components <img class="formulaInl" alt="$\tilde{F}_{j,s}^{\pm}$" src="form_144.png"/> to obtain the corresponding component of the numerical flux. If we let <img class="formulaInl" alt="$\Phi_{WENO5}$" src="form_145.png"/> denote the fifth-order WENO reconstruction operator, then the flux is computed as follows: </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \begin{align*} \tilde{F}_{i+\frac{1}{2},s}^{+} &amp;= \Phi_{WENO5}(\tilde{F}_{i-2,s}^{+},\tilde{F}_{i-1,s}^{+},\tilde{F}_{i,s}^{+},\tilde{F}_{i+1,s}^{+},\tilde{F}_{i+2,s}^{+}), \\ \tilde{F}_{i+\frac{1}{2},s}^{-} &amp;= \Phi_{WENO5}(\tilde{F}_{i+3,s}^{-},\tilde{F}_{i+2,s}^{-},\tilde{F}_{i+1,s}^{-},\tilde{F}_{i,s}^{-},\tilde{F}_{i-1,s}^{-}). \end{align*} \]" src="form_146.png"/>
</p>
<p> Then set </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \begin{align*} \tilde{F}_{i+\frac{1}{2},s} = \tilde{F}_{i+\frac{1}{2},s}^{+} + \tilde{F}_{i+\frac{1}{2},s}^{-}, \end{align*} \]" src="form_147.png"/>
</p>
<p> where <img class="formulaInl" alt="$\tilde{F}_{i+\frac{1}{2},s}$" src="form_148.png"/> is the <img class="formulaInl" alt="$s$" src="form_133.png"/>th component of <img class="formulaInl" alt="$\tilde{\mathbf{F}}_{i+\frac{1}{2}}$" src="form_149.png"/>.  Finally, project the numerical flux back to the conserved variables </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \begin{align*} \hat{\mathbf{F}}_{i+\frac{1}{2}} = \mathbf{R}_{i+\frac{1}{2}}\tilde{\mathbf{F}}_{i+\frac{1}{2}}. \end{align*} \]" src="form_150.png"/>
</p>
<h2><a class="anchor" id="reconstruction"></a>
WENO reconstruction operator</h2>
<p>We consider the problem on a uniform grid with <img class="formulaInl" alt="$N+1$" src="form_151.png"/> grid points, </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \begin{align*} a = x_{0} &lt; x_{1} &lt; \cdots &lt; x_{N} = b. \end{align*} \]" src="form_152.png"/>
</p>
<p> We would like to reconstruct <img class="formulaInl" alt="$f$" src="form_2.png"/> at <img class="formulaInl" alt="$x_{i+\frac{1}{2}}$" src="form_153.png"/> by WENO reconstruction on the stencil <img class="formulaInl" alt="$S = \{I_{i-2},I_{i-1},...,I_{i+2}\}$" src="form_154.png"/>. There are three sub-stencils for node <img class="formulaInl" alt="$x_{i+\frac{1}{2}}$: $S^{0} = \{I_{i-2},I_{i-1},I_{i}\}$" src="form_155.png"/>, <img class="formulaInl" alt="$S^{1} = \{I_{i-1},I_{i},I_{i+1}\}$" src="form_156.png"/> and <img class="formulaInl" alt="$S^{2} = \{I_{i},I_{i+1},I_{i+2}\}$" src="form_157.png"/>. In each sub-stencil <img class="formulaInl" alt="$S_{i+\frac{1}{2}}^{k}$" src="form_158.png"/>, the third-order accurate numerical flux <img class="formulaInl" alt="$\hat{f}_{i+\frac{1}{2}}^{k}$" src="form_159.png"/> is given by </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \begin{align*} \hat{f}_{i+\frac{1}{2}}^{0} &amp;= \frac{1}{3}f_{i-2} - \frac{7}{6}f_{i-1} + \frac{11}{6}f_{i}, \\ \hat{f}_{i+\frac{1}{2}}^{1} &amp;= -\frac{1}{6}f_{i-1} + \frac{5}{6}f_{i} + \frac{1}{3}f_{i+1}, \\ \hat{f}_{i+\frac{1}{2}}^{2} &amp;= \frac{1}{3}f_{i} + \frac{5}{6}f_{i+1} - \frac{1}{6}f_{i+2}. \end{align*} \]" src="form_160.png"/>
</p>
<p> The numerical approximation <img class="formulaInl" alt="$\hat{f}_{i+\frac{1}{2}}$" src="form_161.png"/> is defined as a linear convex combination of the above three approximations: </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \begin{align*} \hat{f}_{i+\frac{1}{2}} = w_{0}\hat{f}_{i+\frac{1}{2}}^{0} + w_{1}\hat{f}_{i+\frac{1}{2}}^{1} + w_{2}\hat{f}_{i+\frac{1}{2}}^{2}, \end{align*} \]" src="form_162.png"/>
</p>
<p> where the nonlinaer weights are defined as </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \begin{align*} w_{k} &amp;= \frac{\tilde{w}_{k}}{\tilde{w}_{0}+\tilde{w}_{1}+\tilde{w}_{2}}, \\ \tilde{w}_{0} &amp;= \frac{1}{(\epsilon+\beta_{0})^2},\quad \tilde{w}_{1} = \frac{6}{(\epsilon+\beta_{1})^2}, \quad \tilde{w}_{2} = \frac{3}{(\epsilon+\beta_{2})^2}. \end{align*} \]" src="form_163.png"/>
</p>
<p> We take <img class="formulaInl" alt="$\epsilon = 10^{-6}$" src="form_164.png"/> and the smoothness indicator parameters, <img class="formulaInl" alt="$\beta_{k}$" src="form_165.png"/>, are chosen as in <a class="el" href="citelist.html#CITEREF_Jiang1996:fifth">[2]</a> </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \begin{align*} \beta_{0} &amp;= \frac{13}{12}(f_{i-2}-2f_{i-1}+f_{i})^{2} + \frac{1}{4}(f_{i-2}-4f_{i-1}+3f_{i})^{2}, \\ \beta_{1} &amp;= \frac{13}{12}(f_{i-1}-2f_{i}+f_{i+1})^{2} + \frac{1}{4}(f_{i-1}-f_{i+1})^{2}, \\ \beta_{2} &amp;= \frac{13}{12}(f_{i}-2f_{i+1}+f_{i+2})^{2} + \frac{1}{4}(3f_{i}-4f_{i+1}+f_{i+2})^{2}. \end{align*} \]" src="form_166.png"/>
</p>
<p> From these we define the fifth-order WENO reconstruction operator <img class="formulaInl" alt="$\Phi_{WENO5}$" src="form_145.png"/> as follows: </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \begin{align*} \Phi_{WENO5}(f_{i-2},f_{i-1},f_{i},f_{i+1},f_{i+2}) = w_{0}\hat{f}_{i+\frac{1}{2}}^{0} + w_{1}\hat{f}_{i+\frac{1}{2}}^{1} + w_{2}\hat{f}_{i+\frac{1}{2}}^{2}. \end{align*} \]" src="form_167.png"/>
</p>
<h2><a class="anchor" id="freestream"></a>
Freestream preservation on curvilinear grids</h2>
<p>For freestream preservation on curvilinear grids, steps 5 and 6 in the WENO procedure are modified following <a class="el" href="citelist.html#CITEREF_nonomura2015new">[8]</a>. The WENO flux is devided to a central and a dissipation part <a class="el" href="citelist.html#CITEREF_jiang1999high">[3]</a> </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \begin{equation*} \mathbf{F}_{j+1/2}=\mathbf{F}_{\textrm{central},j+1/2}+\mathbf{F}_{\textrm{dissipation},j+1/2}, \end{equation*} \]" src="form_168.png"/>
</p>
<p> where </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \begin{equation*} \mathbf{F}_{\textrm{central},j+1/2}=\frac{1}{60}\left(\mathbf{F}_{j-2}-8\mathbf{F}_{j-1}+37\mathbf{F}_j+37\mathbf{F}_{j+1}-8\mathbf{F}_{j+2}+\mathbf{F}_{j+3}\right), \end{equation*} \]" src="form_169.png"/>
</p>
<p> corresponds to a <img class="formulaInl" alt="$6^{th}$" src="form_170.png"/>-order central finite difference scheme. The dissipation part becomes </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \begin{align*} F_{\textrm{dissipation,m},j+1/2}=\Sigma_m \frac{r_m}{60}\left[(20 w_m^{-1} -1) F_m'^{-1} -(10(w_m^{-1}+w_m^{-1})-5) F_m'^{-2}+F_m'^{-1}\right]\\ -\Sigma_m \frac{r_m}{60}\left[(20 w_m^{+1} -1) F_m'^{+1} -(10(w_m^{+1}+w_m^{+1})-5) F_m'^{+2}+F_m'^{+1}\right], \end{align*} \]" src="form_171.png"/>
</p>
<p> where <img class="formulaInl" alt="$r_m$" src="form_172.png"/> is the corresponding right eigenvector, and </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \begin{align*} F_m'^{+1}= f_{j+1,m}^{+}-3 f_{j,m}^{+}+3 f_{j-1,m}^{+}-f_{j-2,m}^{+},\\ F_m'^{+2}= f_{j+2,m}^{+}-3 f_{j+1,m}^{+}+3 f_{j,m}^{+}-f_{j-1,m}^{+},\\ F_m'^{+3}= f_{j+3,m}^{+}-3 f_{j+2,m}^{+}+3 f_{j+1,m}^{+}-f_{j,m}^{+},\\ F_m'^{-1}= f_{j+3,m}^{-}-3 f_{j+2,m}^{-}+3 f_{j+1,m}^{+}-f_{j,m}^{-},\\ F_m'^{-2}= f_{j+2,m}^{-}-3 f_{j+1,m}^{-}+3 f_{j,m}^{+}-f_{j-1,m}^{-},\\ F_m'^{-3}= f_{j+1,m}^{-}-3 f_{j,m}^{-}+3 f_{j-1,m}^{-}-f_{j-2,m}^{-}. \end{align*} \]" src="form_173.png"/>
</p>
<p> In this formulation </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \begin{equation*} f^{\pm}_{k,m}=\frac{l_m}{2}\left[\left(\frac{\xi_x}{J}\right)_{j+1/2} \mathbf{E}_k +\left(\frac{\xi_y}{J}\right)_{j+1/2} \mathbf{F}_k +\left(\frac{\xi_z}{J}\right)_{j+1/2} \mathbf{G}_k +\pm \lambda_m \frac{\mathbf{Q}_k}{J_{i+1/2}} \right], \end{equation*} \]" src="form_174.png"/>
</p>
<p> where <img class="formulaInl" alt="$l_m$" src="form_175.png"/> is the corresponding right eigenvector. For freestream preservation, the metric term for evaluation the dissipation part of the flux is defined as <a class="el" href="citelist.html#CITEREF_jiang1999high">[3]</a> </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \begin{equation*} \left(\frac{\xi_x}{J}\right)_{j+1/2}=\frac{1}{2}\left[\left(\frac{\xi_x}{J}\right)_j+\left(\frac{\xi_x}{J}\right)_{j+1}\right]. \end{equation*} \]" src="form_176.png"/>
</p>
<h1><a class="anchor" id="nscbc"></a>
Boundary treatment using the characteristic wave relations</h1>
<p>For points on the boundary, we may use the characteristic wave relations to obtain the flux at that point.</p>
<h2><a class="anchor" id="charspace"></a>
Characteristic space</h2>
<p>Equations in the characteristic space are <a class="el" href="citelist.html#CITEREF_kim2004generalized">[5]</a> </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \begin{equation*} \frac{\partial \mathbf{R}}{\partial t}+\mathbf{L}=\mathbf{S_c}, \end{equation*} \]" src="form_177.png"/>
</p>
<p> where </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \begin{equation*} \delta \mathbf{R}= P^{-1} \delta Q, \quad \mathbf{L}=\lambda \frac{\partial R}{\partial \xi}=P^{-1}\left(\xi_x \frac{\partial E}{\partial \xi}+ \xi_y \frac{\partial F}{\partial \xi}+\xi_z \frac{\partial G}{\partial \xi} \right), \end{equation*} \]" src="form_178.png"/>
</p>
<p> and </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \begin{equation*} \mathbf{S_c}=J P^{-1}\left[\hat{\mathbf{S}_v}-\left[\mathbf{E}\frac{\partial}{\partial \xi}\left(\frac{\xi_x}{J}\right)+\mathbf{F} \frac{\partial}{\partial \xi}\left( \xi_y\right)+\mathbf{G} \frac{\partial}{\partial \xi}\left(\frac{\xi_z}{J}\right)+\frac{\partial \hat{\mathbf{F}}}{\partial \eta}+\frac{\partial \hat{\mathbf{G}}} {\partial \zeta} \right]\right]. \end{equation*} \]" src="form_179.png"/>
</p>
<p> Also note that </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \begin{equation*} \left(\xi_x \frac{\partial E}{\partial \xi}+ \xi_y \frac{\partial F}{\partial \xi}+\xi_z \frac{\partial G}{\partial \xi} \right)=J\left(\frac{\partial \hat{E}}{\partial \xi}-\left[E\frac{\partial}{\partial \xi}\left(\frac{\xi_x}{J}\right)+F \frac{\partial}{\partial \xi}\left( \xi_y\right)+G \frac{\partial}{\partial \xi}\left(\frac{\xi_z}{J}\right) \right]\right). \end{equation*} \]" src="form_180.png"/>
</p>
<p> Characteristic variables are </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \begin{equation*} \delta \mathbf{R}=\left[\delta \rho -\frac{\delta p}{c^2}, \delta \tilde{w},\delta \tilde{v},\frac{\delta p}{\rho c}+\delta \tilde{u}, \frac{\delta p}{\rho c}-\delta \tilde{u}\right]^T. \end{equation*} \]" src="form_181.png"/>
</p>
<p> where </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \begin{equation*} u=\xi_x u +\xi_y v+\xi_z w, \quad \delta \tilde{u}=\tilde{\xi}_x \delta u+ \tilde{\xi}_y \delta v+\tilde{\xi}_z \delta w, \quad \delta \tilde{v}=-\tilde{\xi}_x \delta v +\tilde{\xi}_y \delta u, \quad \delta \tilde{w}=-\tilde{\xi}_x \delta w -\tilde{\xi}_z \delta u. \end{equation*} \]" src="form_182.png"/>
</p>
<p> and </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \begin{equation*} \left[\tilde{\xi}_x,\tilde{\xi}_y,\tilde{\xi}_z\right]=\frac{\left[\xi_x, \xi_y, \xi_z \right]}{\sqrt{\xi_x^2+\xi_y^2+\xi_z^2}} \end{equation*} \]" src="form_183.png"/>
</p>
<p> Wave speeds are </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \begin{equation*} \mathbf{\lambda}=\left[u,u,u,u+c\sqrt{\xi_x^2+\xi_y^2+\xi_z^2},u-c\sqrt{\xi_x^2+\xi_y^2+\xi_z^2}\right]^T. \end{equation*} \]" src="form_184.png"/>
</p>
<h2><a class="anchor" id="charprim"></a>
Characteristic space in terms of primitive variables</h2>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \begin{equation*} \frac{\partial \rho}{\partial t}+L_1+\frac{\rho}{2c}(L_4+L_5)=S_{c1}+\frac{\rho}{2c}(S_{c4}+S_{c5}) \end{equation*} \]" src="form_185.png"/>
</p>
 <p class="formulaDsp">
<img class="formulaDsp" alt="\[ \begin{equation*} \frac{\partial \tilde{u}}{\partial t}+\frac{1}{2}(L_4-L_5)=\frac{1}{2}(S_{c4}-S_{c5}) \end{equation*} \]" src="form_186.png"/>
</p>
 <p class="formulaDsp">
<img class="formulaDsp" alt="\[ \begin{equation*} \frac{\partial \tilde{v}}{\partial t}+L_2=S_{c2} \end{equation*} \]" src="form_187.png"/>
</p>
 <p class="formulaDsp">
<img class="formulaDsp" alt="\[ \begin{equation*} \frac{\partial \tilde{w}}{\partial t}+L_3=S_{c3} \end{equation*} \]" src="form_188.png"/>
</p>
 <p class="formulaDsp">
<img class="formulaDsp" alt="\[ \begin{equation*} \frac{\partial p}{\partial t}+\frac{\rho c}{2}(L_4+L_5)=\frac{\rho c}{2}(S_{c4}+S_{c5}) \end{equation*} \]" src="form_189.png"/>
</p>
<h2><a class="anchor" id="ovimp"></a>
Overall implementation procedure</h2>
<p>Use one-sided finite differences to calculate <img class="formulaInl" alt="$\partial \hat{\mathbf{E}}/\partial \xi$" src="form_190.png"/></p>
<p>Evaluate the $L$ vector </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \begin{equation*} \mathbf{L}=J P^{-1}\left[\frac{\partial \hat{E}}{\partial \xi}-\left[E\frac{\partial}{\partial \xi}\left(\frac{\xi_x}{J}\right)+F \frac{\partial}{\partial \xi}\left( \xi_y\right)+G \frac{\partial}{\partial \xi}\left(\frac{\xi_z}{J}\right) \right]\right] \end{equation*} \]" src="form_191.png"/>
</p>
<p>Evaluate <img class="formulaInl" alt="$L^*$" src="form_60.png"/> based on the applied boundary condition</p>
<p>Come back to the computational space from the characteristic space: </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \begin{equation*} \left(\frac{\partial \hat{\mathbf{E}}}{\partial \xi} \right)^*=\frac{1}{J}P L^*+\left[E\frac{\partial}{\partial \xi}\left(\frac{\xi_x}{J}\right)+F \frac{\partial}{\partial \xi}\left( \xi_y\right)+G \frac{\partial}{\partial \xi}\left(\frac{\xi_z}{J}\right) \right] \end{equation*} \]" src="form_192.png"/>
</p>
<h2><a class="anchor" id="bcbc"></a>
Applying boundary conditions on \f$\mathbf{L}^*\f$</h2>
<p>Subsonic inflow:</p>
<p>solves for <img class="formulaInl" alt="$\rho$" src="form_14.png"/> </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \begin{equation*} L_1=\frac{\gamma -1}{2}{\rho}{c}(L_4+L_5)+\frac{c^2}{\gamma-1}\frac{\partial T}{\partial t}. \end{equation*} \]" src="form_193.png"/>
</p>
 <p class="formulaDsp">
<img class="formulaDsp" alt="\[ \begin{equation*} \text{if}\ \ n&gt;0, \quad L_4=L_5-2\left(\frac{\partial u}{\partial t}\xi_x+\frac{\partial v}{\partial t}\xi_y\right), \end{equation*} \]" src="form_194.png"/>
</p>
 <p class="formulaDsp">
<img class="formulaDsp" alt="\[ \begin{equation*} \text{if}\ \ n&lt;0, \quad L_5=L_4+2\left(\frac{\partial u}{\partial t}\xi_x+\frac{\partial v}{\partial t}\xi_y\right), \end{equation} \]" src="form_195.png"/>
</p>
<p> where <img class="formulaInl" alt="$n$" src="form_41.png"/> is the normal vector at the boundary. sets <img class="formulaInl" alt="$u,v,w, T,Y_i$" src="form_196.png"/></p>
<p>Supersonic inflow:</p>
<p>sets everything <img class="formulaInl" alt="$\rho,u,v,w,p,Y_i$" src="form_197.png"/></p>
<p>Outflow no-reflection: solves for all variables </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \begin{equation*} \text{if}\ \ n&gt;0, \text{and} \ \ \alpha_i&gt;0, \quad L_i=0 \end{equation*} \]" src="form_198.png"/>
</p>
 <p class="formulaDsp">
<img class="formulaDsp" alt="\[ \begin{equation*} \text{if}\ \ n&lt;0, \text{and} \ \ \alpha_i&lt;0, \quad L_i=0 \end{equation*} \]" src="form_199.png"/>
</p>
<p> doesn't set any variables</p>
<p>Adiabatic slip wall: Solves for everything </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \begin{equation*} L_1=L_2=L_3=0, \quad L_{6,...}=0 \end{equation*} \]" src="form_200.png"/>
</p>
 <p class="formulaDsp">
<img class="formulaDsp" alt="\[ \begin{equation*} \text{if}\ \ n&gt;0, \quad L_4=L_5-2A_{\text{wall}} \end{equation*} \]" src="form_201.png"/>
</p>
 <p class="formulaDsp">
<img class="formulaDsp" alt="\[ \begin{equation*} \text{if}\ \ n&lt;0, \quad L_5=L_4 +2 A_{\text{wall}} \end{equation*} \]" src="form_202.png"/>
</p>
<p> sets velocity <img class="formulaInl" alt="$[u,v,w]$" src="form_203.png"/>, enforces the normal velocity to be <img class="formulaInl" alt="$A_{\text{wall}}$" src="form_204.png"/></p>
<p>Isothermal no-slip wall:</p>
<p>solves for <img class="formulaInl" alt="$\rho, \rho Y_i$" src="form_205.png"/> </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \begin{equation*} L_1=L_2=L_3=0, \quad L_{6,...}=0 \end{equation*} \]" src="form_200.png"/>
</p>
 <p class="formulaDsp">
<img class="formulaDsp" alt="\[ \begin{equation*} \text{if}\ \ n&gt;0, \quad L_4=L_5 \end{equation*} \]" src="form_206.png"/>
</p>
 <p class="formulaDsp">
<img class="formulaDsp" alt="\[ \begin{equation*} \text{if}\ \ n&lt;0, \quad L_5=L_4 \end{equation*} \]" src="form_207.png"/>
</p>
<p> sets velocity <img class="formulaInl" alt="$[u,v,w]=\mathbf{V}_{\text{wall}}$" src="form_208.png"/></p>
<p>sets <img class="formulaInl" alt="$T$" src="form_209.png"/></p>
<h1><a class="anchor" id="eigenvectors"></a>
Right and left eigenvectors</h1>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \begin{equation*} b_1=\frac{p_e}{\rho c^2}=\frac{\gamma-1}{c^2}, \qquad b_2=1+b_1 q^2-b_1 H, \qquad b_3=-\Sigma_{i=1}^{N-1}\frac{Y_i p_{\rho Y_i}}{c^2}=b_1 \Sigma_{i=1}^{N-1}Y_i z_i, \quad \beta=\frac{\gamma -1}{\rho c}, \end{equation*} \begin{equation*} z_i=\frac{-1}{\gamma -1} \left(\frac{dp}{d(\rho Y_i)} \right)=\frac{c_p (R_N - R_i)T}{R}+h_i-h_N=-\frac{\rho p_{\rho Y_i}}{p_e}, \quad b_1z_i=-\frac{p_{\rho Y_i}}{c^2}, \end{equation*} \]" src="form_210.png"/>
</p>
<p>Two-dimensional single-fluid: </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \begin{equation*} R= \begin{bmatrix} 1 &amp; 0 &amp; \frac{\rho}{2c} &amp; \frac{\rho}{2c}\\ u &amp; \rho \tilde{\xi_y} &amp; \frac{\rho}{2c} \left(u+c \tilde{\xi_x}\right) &amp; \frac{\rho}{2c} \left(u-c \tilde{\xi_x}\right) \\ v &amp; -\rho \tilde{\xi_x} &amp; \frac{\rho}{2c} \left(v+c \tilde{\xi_y}\right) &amp; \frac{\rho}{2c} \left(v-c \tilde{\xi_y}\right) \\ H-\frac{\rho c^2}{p_e} &amp; \rho \left( u \tilde{\xi_y} -v \tilde{\xi_x}\right) &amp; \frac{\rho}{2c} \left(H+c \dot{V}_{\xi}\right) &amp; \frac{\rho}{2c} \left(H-c \dot{V}_{\xi}\right) \\ \end{bmatrix}, \end{equation*} \]" src="form_211.png"/>
</p>
<p> and </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \begin{equation*} L= \begin{bmatrix} 1-b_2 &amp; b_1 u &amp; b_1 v &amp; -b_1 \\ -\frac{1}{\rho}(u \tilde{\xi_y}-v\tilde{\xi_x}) &amp; \frac{1}{\rho}\tilde{\xi_y} &amp; \frac{-1}{\rho}\tilde{\xi_x} \\ \beta c^2(b_2-\frac{\hat{u}}{c}) &amp; \beta c (\tilde \xi_x - b_1 u c) &amp; \beta c (\tilde\xi_y -b_1 vc) &amp; \beta b_1 c^2 &amp; -\beta b_1z_1 c^2 \\ \beta c^2(b_2+\frac{\hat{u}}{c}) &amp; -\beta c (\tilde\xi_x + b_1 u c) &amp; -\beta c (\tilde \xi_y +b_1 vc) &amp; \beta b_1 c^2 \\ \end{bmatrix}. \end{equation*} \]" src="form_212.png"/>
</p>
<p>Two-dimensional multi-component:</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \begin{equation*} R= \begin{bmatrix} 1 &amp; 0 &amp; \alpha &amp; \alpha &amp; 0 &amp; 0&amp; 0\\ u &amp; \rho \tilde{\xi_y} &amp; \alpha \left(u+c \tilde{\xi_x}\right) &amp;\alpha \left(u-c \tilde{\xi_x}\right)&amp; 0 &amp; 0&amp; 0 \\ v &amp; -\rho \tilde{\xi_x} &amp; \alpha \left(v+c \tilde{\xi_y}\right) &amp; \alpha \left(v-c \tilde{\xi_y}\right) &amp; 0 &amp; 0&amp; 0 \\ H-\frac{\rho c^2}{p_e} &amp; \rho \left( u \tilde{\xi_y} -v \tilde{\xi_x}\right) &amp; \alpha \left(H+c \hat{u}\right) &amp;\alpha \left(H-c \hat{u}\right) &amp; z_1 &amp; z_2 &amp; z_3\\ Y_1 &amp; 0 &amp; \alpha Y_1 &amp; \alpha Y_1 &amp; 1 &amp; 0 &amp; 0 \\ Y_2 &amp; 0 &amp; \alpha Y_2 &amp; \alpha Y_2 &amp;0 &amp; 1 &amp; 0 \\ Y_3 &amp; 0 &amp; \alpha Y_3 &amp; \alpha Y_3 &amp;0 &amp; 0 &amp; 1 \\ \end{bmatrix}, \end{equation*} \]" src="form_213.png"/>
</p>
<p>and</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \begin{equation*} L= \begin{bmatrix} 1-b_2-b_3 &amp; b_1 u &amp; b_1 v &amp; -b_1 &amp; b_1z_1 &amp; b_1 z_2 &amp; b_1 z_3\\ -\frac{1}{\rho}(u \tilde{\xi_y}-v\tilde{\xi_x}) &amp; \frac{1}{\rho}\tilde{\xi_y} &amp; \frac{-1}{\rho}\tilde{\xi_x} &amp; 0 &amp; 0 &amp; 0 &amp;0\\ \beta c^2(b_2+b_3-\frac{\hat{u}}{c}) &amp; \beta c (\tilde \xi_x - b_1 u c) &amp; \beta c (\tilde\xi_y -b_1 vc) &amp; \beta b_1 c^2 &amp; -\beta b_1z_1 c^2 &amp; -\beta b_1z_2 c^2 &amp; -\beta b_1 z_3 c^2\\ \beta c^2(b_2+b_3+\frac{\hat{u}}{c}) &amp; -\beta c (\tilde\xi_x + b_1 u c) &amp; -\beta c (\tilde \xi_y +b_1 vc) &amp; \beta b_1 c^2 &amp; -\beta b_1z_1 c^2 &amp; -\beta b_1z_2 c^2 &amp; -\beta b_1 z_3 c^2\\ -Y_1 &amp; 0 &amp; 0 &amp; 0 &amp; 1 &amp; 0 &amp; 0\\ -Y_2 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 1 &amp; 0\\ -Y_3 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 1\\ \end{bmatrix}. \end{equation*} \]" src="form_214.png"/>
</p>
<p>Improved three-dimensional eigenvectors following <a class="el" href="citelist.html#CITEREF_nonomura2017characteristic">[7]</a> used with the WENO solver:</p>
<p>Three-dimensional single-fluid:</p>
<p>For eigenvectors in the <img class="formulaInl" alt="$x-$" src="form_215.png"/>direction: </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \begin{equation*} (k_x,k_y,k_z)=\frac{(\xi_x,\xi_y,\xi_z)}{\sqrt{\xi_x^2+\xi_y^2+\xi_z^2}},\quad (l_x,l_y,l_z)=\frac{(\eta_x,\eta_y,\eta_z)}{\sqrt{\eta_x^2+\eta_y^2+\eta_z^2}},\quad (m_x,m_y,m_z)=\frac{(\zeta_x,\zeta_y,\zeta_z)}{\sqrt{\zeta_x^2+\zeta_y^2+\zeta_z^2}}, \end{equation*} \]" src="form_216.png"/>
</p>
 <p class="formulaDsp">
<img class="formulaDsp" alt="\[ \begin{equation*} \tilde{u}=k_x u+k_y v+k_z w, \quad \tilde{v}=l_x u+l_y v+l_z w, \quad \tilde{w}=m_x u+m_y v+m_z w, \end{equation*} \]" src="form_217.png"/>
</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \begin{equation*} \alpha= \frac{\rho}{2c}, \end{equation*} \]" src="form_218.png"/>
</p>
 <p class="formulaDsp">
<img class="formulaDsp" alt="\[ \begin{equation*} R= \begin{bmatrix} 1 &amp; 0 &amp; 0 &amp; \alpha &amp; \alpha \\ u &amp; \rho l_x&amp; \rho m_x &amp; \alpha (u+c k_x) &amp; \alpha (u-c k_x) \\ v &amp; \rho l_y &amp; \rho m_y &amp; \alpha (v+c k_y) &amp; \alpha (v-c k_y) \\ w &amp; \rho l_z &amp; \rho m_z &amp; \alpha (w+c k_z) &amp; \alpha (w-c k_z) \\ \frac{1}{2}(u^2+v^2+w^2) &amp; \rho \tilde{v} &amp; \rho \tilde{w} &amp;\alpha (H+c \tilde{u}) &amp; \alpha (H-c \tilde{u} ) \end{bmatrix}, \end{equation*} \]" src="form_219.png"/>
</p>
<p> and </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \begin{equation*} \alpha=\frac{\gamma-1}{c^2}, \quad b_1=\frac{\gamma -1}{c^2}, \quad b_2= \frac{\gamma -2}{2}M^2, \quad M^2=\frac{u^2+v^2+w^2}{c^2}, \end{equation*} \]" src="form_220.png"/>
</p>
 <p class="formulaDsp">
<img class="formulaDsp" alt="\[ \begin{equation*} L= \begin{bmatrix} 1-b_2 &amp; b_1 u &amp; b_1 v &amp; b_1 w &amp; -b_1 \\ -\frac{\tilde{v}}{\rho} &amp; \frac{l_x}{\rho}&amp; \frac{l_y}{\rho}&amp; \frac{l_z}{\rho} &amp; 0\\ -\frac{\tilde{w}}{\rho} &amp; \frac{m_x}{\rho}&amp; \frac{m_y}{\rho}&amp; \frac{m_z}{\rho} &amp; 0\\ \frac{1}{2\alpha}\left(b_2-\frac{\tilde{u}}{c}\right)&amp; \frac{-1}{2\alpha}\left(b_1u-\frac{k_x}{c}\right)&amp; \frac{-1}{2\alpha}\left(b_1v-\frac{k_y}{c}\right) &amp; \frac{-1}{2\alpha}\left(b_1w-\frac{k_z}{c}\right) &amp; \frac{1}{2\alpha}b_1\\ \frac{1}{2\alpha}\left(b_2+\frac{\tilde{u}}{c}\right)&amp; \frac{-1}{2\alpha}\left(b_1u+\frac{k_x}{c}\right)&amp; \frac{-1}{2\alpha}\left(b_1v+\frac{k_y}{c}\right) &amp; \frac{-1}{2\alpha}\left(b_1w+\frac{k_z}{c}\right) &amp; \frac{1}{2\alpha}b_1\\ \end{bmatrix}. \end{equation*} \]" src="form_221.png"/>
</p>
<p>Three-dimensional multi-component:</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \begin{equation*} R= \begin{bmatrix} 1 &amp; 0 &amp; 0 &amp; \alpha &amp; \alpha &amp; 0 &amp; 0 &amp; 0\\ u &amp; \rho l_x&amp; \rho m_x &amp; \alpha (u+c k_x) &amp; \alpha (u-c k_x) &amp; 0 &amp; 0 &amp; 0\\ v &amp; \rho l_y &amp; \rho m_y &amp; \alpha (v+c k_y) &amp; \alpha (v-c k_y) &amp; 0 &amp; 0 &amp; 0\\ w &amp; \rho l_z &amp; \rho m_z &amp; \alpha (w+c k_z) &amp; \alpha (w-c k_z)&amp; 0 &amp; 0 &amp; 0 \\ \frac{1}{2}(u^2+v^2+w^2) &amp; \rho \tilde{v} &amp; \rho \tilde{w} &amp;\alpha (H+c \tilde{u}) &amp; \alpha (H-c \tilde{u} )&amp; z_1 &amp; z_2 &amp; z_3\\ Y_1 &amp; 0 &amp; 0 &amp; \alpha Y_1 &amp; \alpha Y_1 &amp; 1 &amp; 0 &amp; 0\\ Y_2 &amp; 0 &amp; 0 &amp; \alpha Y_2 &amp; \alpha Y_2&amp; 0 &amp; 1 &amp; 0\\ Y_3 &amp; 0 &amp; 0 &amp; \alpha Y_3 &amp; \alpha Y_3 &amp; 0 &amp; 0 &amp; 1\\ \end{bmatrix}, \end{equation*} \]" src="form_222.png"/>
</p>
<p>and</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \begin{equation*} L= \begin{bmatrix} 1-b_2-b_3 &amp; b_1 u &amp; b_1 v &amp; b_1 w &amp; -b_1 &amp; b_1z_1 &amp; b_1 z_2 &amp; b_1 z_3\\ -\frac{\tilde{v}}{\rho} &amp; \frac{l_x}{\rho}&amp; \frac{l_y}{\rho}&amp; \frac{l_z}{\rho} &amp; 0 &amp; 0 &amp; 0 &amp; 0\\ -\frac{\tilde{w}}{\rho} &amp; \frac{m_x}{\rho}&amp; \frac{m_y}{\rho}&amp; \frac{m_z}{\rho} &amp; 0 &amp; 0 &amp; 0 &amp; 0\\ \frac{1}{2\alpha}\left(b_2+b_3-\frac{\tilde{u}}{c}\right)&amp; \frac{-1}{2\alpha}\left(b_1u-\frac{k_x}{c}\right)&amp; \frac{-1}{2\alpha}\left(b_1v-\frac{k_y}{c}\right) &amp; \frac{-1}{2\alpha}\left(b_1w-\frac{k_z}{c}\right) &amp; \frac{1}{2\alpha}b_1 &amp; \frac{-b_1z_1c}{\rho} &amp; \frac{-b_1z_2c}{\rho} &amp; \frac{-b_1z_3c}{\rho}\\ \frac{1}{2\alpha}\left(b_2+b_3\frac{\tilde{u}}{c}\right)&amp; \frac{-1}{2\alpha}\left(b_1u+\frac{k_x}{c}\right)&amp; \frac{-1}{2\alpha}\left(b_1v+\frac{k_y}{c}\right) &amp; \frac{-1}{2\alpha}\left(b_1w+\frac{k_z}{c}\right) &amp; \frac{1}{2\alpha}b_1 &amp; \frac{-b_1z_1c}{\rho} &amp; \frac{-b_1z_2c}{\rho} &amp; \frac{-b_1z_3c}{\rho}\\ -Y_1 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 1 &amp; 0 &amp; 0\\ -Y_2 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 1 &amp; 0\\ -Y_3 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 1\\ \end{bmatrix}. \end{equation*} \]" src="form_223.png"/>
</p>
<h1><a class="anchor" id="Roeaverage"></a>
Roe average</h1>
<p>The WENO reconstruction is performed in the characteristic space. Consequently, the left and right eigenvectors are required to transform the fluxes from the physical space to the characteristic space. When calculating the flux at a cell edge <img class="formulaInl" alt="$i+\frac{1}{2}$" src="form_224.png"/>, the Roe average between points <img class="formulaInl" alt="$i$" src="form_21.png"/> and <img class="formulaInl" alt="$i+1$" src="form_225.png"/> are used to construct the right and left eigenvectors shown in section~sec:eigenvectors}. The Roe average state <img class="formulaInl" alt="$\tilde{U}$" src="form_226.png"/> is defined such that <a class="el" href="citelist.html#CITEREF_shuen1992upwind">[10]</a> <a class="el" href="citelist.html#CITEREF_shuen1990inviscid">[9]</a> </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \begin{equation*}\label{eq:Roe} \Delta F = \tilde{A}\Delta U, \quad \tilde{A}=\tilde{A}(\tilde{U}),\quad \tilde{U}=\tilde{U}(U_L, U_R), \end{equation*} \]" src="form_227.png"/>
</p>
<p> where </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \begin{equation*} \Delta(\cdot)=(\cdot)_L-(\cdot)_R. \end{equation*} \]" src="form_228.png"/>
</p>
<p> The Roe average operator <img class="formulaInl" alt="$R$" src="form_49.png"/> is </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \begin{equation*} R(f)= \frac{\sqrt{\rho_R}f_R+\sqrt{\rho_L}f_L}{\sqrt{\rho_R}+\sqrt{\rho_L}}. \end{equation*} \]" src="form_229.png"/>
</p>
<p> It can be shown that (eq:Roe}) is satisfied by </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \begin{equation*} \tilde{\rho}=\sqrt{\rho_L\rho_R}, \quad \tilde{u}=R(u), \quad\tilde{e}=R(e), \quad\tilde{H}=R(H), \quad \tilde{Y_i}=R(Y_i). \end{equation*} \]" src="form_230.png"/>
</p>
<p> For a thermally perfect gas mixture, we choose the set <img class="formulaInl" alt="$(\tilde{\rho},\tilde{u}, \tilde{e},\tilde{H},\tilde{Y_i},\tilde{p_{\rho}},\tilde{p_e},\tilde{p_{\rho Y_i}})$" src="form_231.png"/>, which should satisfy the pressure constraint </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \begin{equation*}\label{eq:pconstraint} \Delta p=\tilde{p_{\rho}}\Delta \rho +\tilde{p_e}\Delta e+\Sigma_{i=1}^{N-1}\tilde{p_{\rho Y_i}}\Delta \rho Y_i. \end{equation*} \]" src="form_232.png"/>
</p>
<p> The next step is to define <img class="formulaInl" alt="$(\tilde{p_{\rho}},\tilde{p_e},\tilde{p_{\rho Y_i}})$" src="form_233.png"/> in a consistent way satisfying the above constraint. First, we calculate </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \begin{equation*} \bar{p_{\rho}}=p_{\rho}(\tilde{\rho},\tilde{u}, \tilde{e},\tilde{Y_1},...,\tilde{Y_{N-1}}), \end{equation*} \]" src="form_234.png"/>
</p>
 <p class="formulaDsp">
<img class="formulaDsp" alt="\[ \begin{equation*} \bar{p_{e}}=p_{\rho}(\tilde{\rho},\tilde{u}, \tilde{e},\tilde{Y_1},...,\tilde{Y_{N-1}}), \end{equation*} \]" src="form_235.png"/>
</p>
 <p class="formulaDsp">
<img class="formulaDsp" alt="\[ \begin{equation*} \bar{p_{\rho Y_i}}=p_{\rho}(\tilde{\rho},\tilde{u}, \tilde{e},\tilde{Y_1},...,\tilde{Y_{N-1}}), \qquad i=1,...,N-1. \end{equation*} \]" src="form_236.png"/>
</p>
<p> Next, the pressure residual <img class="formulaInl" alt="$\delta p$" src="form_237.png"/> is evaluated </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \begin{equation*} \delta p=\Delta p-\left(\bar{p_{\rho}}\Delta \rho+\bar{p_e}\Delta e+\Sigma_{i=1}^{N-1}\bar{p_{\rho Y_i}}\Delta \rho Y_i \right). \end{equation*} \]" src="form_238.png"/>
</p>
<p> The Roe average state for the pressure derivatives are then defined as </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \begin{equation*} \tilde{p_e}=\bar{p_e}\left(1+\frac{\bar{p_e}\Delta e}{(\bar{p_e}\Delta e)^2+(\bar{p_{\rho}}\Delta \rho)^2+\Sigma_{i=1}^{N-1}(\bar{p_{\rho Y_i}}\Delta \rho Y_i)^2 } \delta p\right), \end{equation*} \]" src="form_239.png"/>
</p>
 <p class="formulaDsp">
<img class="formulaDsp" alt="\[ \begin{equation*} \tilde{p_{\rho}}=\bar{p_{\rho}}\left(1+\frac{\bar{p_{\rho}}\Delta \rho}{(\bar{p_e}\Delta e)^2+(\bar{p_{\rho}}\Delta \rho)^2+\Sigma_{i=1}^{N-1}(\bar{p_{\rho Y_i}}\Delta \rho Y_i)^2 } \delta p\right), \end{equation*} \]" src="form_240.png"/>
</p>
 <p class="formulaDsp">
<img class="formulaDsp" alt="\[ \begin{equation*} \tilde{p_{\rho Y_i}}=\bar{p_{\rho Y_i}}\left(1+\frac{\bar{p_{\rho Y_i}}\Delta \rho Y_i}{(\bar{p_e}\Delta e)^2+(\bar{p_{\rho}}\Delta \rho)^2+\Sigma_{i=1}^{N-1}(\bar{p_{\rho Y_i}}\Delta \rho Y_i)^2 } \delta p\right), \end{equation*} \]" src="form_241.png"/>
</p>
<p> which ensures satisfying (eq:pconstraint}). The Roe average for thermally perfect gas mixtures is not a unique procedure, but it returns the standard formulation for a calorically perfect gas as <img class="formulaInl" alt="$\delta p$" src="form_237.png"/> vanishes.</p>
<p>The Roe average sound speed is </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \begin{equation*} \tilde{a}^2=\tilde{p_\rho}+\frac{\tilde{p_e}}{\tilde{\rho}}(\tilde{H}-\tilde{e}-\tilde{ke})+\Sigma_{i=1}^{N-1}\tilde Y_i \tilde{p_{\rho Y_i}}. \end{equation*} \]" src="form_242.png"/>
</p>
 </div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Fri Apr 10 2020 12:24:30 for JustKernels by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.12 </li>
  </ul>
</div>
</body>
</html>
