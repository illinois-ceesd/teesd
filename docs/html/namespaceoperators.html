<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.12"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>JustKernels: operators Module Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen_html_style.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="xpacc_logo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">JustKernels
   &#160;<span id="projectnumber">1.0</span>
   </div>
   <div id="projectbrief">XPACC Multiphysics simluation application</div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.12 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('namespaceoperators.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions/Subroutines</a>  </div>
  <div class="headertitle">
<div class="title">operators Module Reference</div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:aee961d7de8b2c319cd0270f5ae735de7"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceoperators.html#aee961d7de8b2c319cd0270f5ae735de7">applyoperator</a> (<a class="el" href="SATKernels_8H.html#a680185db8546de161968dabace9e94f1">numDim</a>, <a class="el" href="SATKernels_8H.html#a338d2e6b5802f9ba652d355df0b1a04b">dimSizes</a>, <a class="el" href="SimpleKernels_8H.html#abb39988074870d597c8d1cfcf61514ee">numComponents</a>, <a class="el" href="ViscidKernels_8H.html#adf0bf75d0875d1bb42a5348bee7b7bfd">numPoints</a>, <a class="el" href="OperatorKernels_8H.html#afc6f027cdb36bf6d86e573c2083e555b">opDir</a>, <a class="el" href="WENOKernels_8H.html#a23d86f4608a92738225f87574392b273">opInterval</a>, <a class="el" href="OperatorKernels_8H.html#a3ebb77d78da88e132f012ab6788ff123">numStencils</a>, <a class="el" href="OperatorKernels_8H.html#ad36f7e6638c24dc8cce030ebb48e32a4">stencilSizes</a>, <a class="el" href="OperatorKernels_8H.html#ab81c9b92fc99d6a20e08f1ad1c9630b0">stencilStarts</a>, numValues, <a class="el" href="OperatorKernels_8H.html#a71782584f6f521c3d69ed8a53fbbbd59">stencilWeights</a>, <a class="el" href="OperatorKernels_8H.html#aace4e878476c6638c99ce2be58848e52">stencilOffsets</a>, <a class="el" href="OperatorKernels_8H.html#a681701e0402fff5dd66637c1c99e34aa">stencilID</a>, <a class="el" href="SimpleKernels_8H.html#aca4ab6143606c908fb1a7de286ddddae">U</a>, dU)</td></tr>
<tr class="memdesc:aee961d7de8b2c319cd0270f5ae735de7"><td class="mdescLeft">&#160;</td><td class="mdescRight">applyoperator applies an operator specified as a stencil set to the provided state data  <a href="#aee961d7de8b2c319cd0270f5ae735de7">More...</a><br /></td></tr>
<tr class="separator:aee961d7de8b2c319cd0270f5ae735de7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad6db84fac96d0301e9802d7504d4b927"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceoperators.html#ad6db84fac96d0301e9802d7504d4b927">applyoperatorv</a> (<a class="el" href="SATKernels_8H.html#a680185db8546de161968dabace9e94f1">numDim</a>, <a class="el" href="SATKernels_8H.html#a338d2e6b5802f9ba652d355df0b1a04b">dimSizes</a>, <a class="el" href="SimpleKernels_8H.html#abb39988074870d597c8d1cfcf61514ee">numComponents</a>, <a class="el" href="ViscidKernels_8H.html#adf0bf75d0875d1bb42a5348bee7b7bfd">numPoints</a>, <a class="el" href="OperatorKernels_8H.html#afc6f027cdb36bf6d86e573c2083e555b">opDir</a>, <a class="el" href="WENOKernels_8H.html#a23d86f4608a92738225f87574392b273">opInterval</a>, <a class="el" href="OperatorKernels_8H.html#a3ebb77d78da88e132f012ab6788ff123">numStencils</a>, <a class="el" href="OperatorKernels_8H.html#ad36f7e6638c24dc8cce030ebb48e32a4">stencilSizes</a>, <a class="el" href="OperatorKernels_8H.html#ab81c9b92fc99d6a20e08f1ad1c9630b0">stencilStarts</a>, numValues, <a class="el" href="OperatorKernels_8H.html#a71782584f6f521c3d69ed8a53fbbbd59">stencilWeights</a>, <a class="el" href="OperatorKernels_8H.html#aace4e878476c6638c99ce2be58848e52">stencilOffsets</a>, <a class="el" href="OperatorKernels_8H.html#a681701e0402fff5dd66637c1c99e34aa">stencilID</a>, <a class="el" href="SimpleKernels_8H.html#aca4ab6143606c908fb1a7de286ddddae">U</a>, dU)</td></tr>
<tr class="memdesc:ad6db84fac96d0301e9802d7504d4b927"><td class="mdescLeft">&#160;</td><td class="mdescRight">applyoperator applies an operator specified as a stencil set to the provided state data  <a href="#ad6db84fac96d0301e9802d7504d4b927">More...</a><br /></td></tr>
<tr class="separator:ad6db84fac96d0301e9802d7504d4b927"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a526cfaf4061ff38e8b9cba873cb1392c"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceoperators.html#a526cfaf4061ff38e8b9cba873cb1392c">applyoperatorblobs</a> (<a class="el" href="SATKernels_8H.html#a680185db8546de161968dabace9e94f1">numDim</a>, <a class="el" href="SATKernels_8H.html#a338d2e6b5802f9ba652d355df0b1a04b">dimSizes</a>, <a class="el" href="SimpleKernels_8H.html#abb39988074870d597c8d1cfcf61514ee">numComponents</a>, <a class="el" href="WENOKernels_8H.html#a86c25ff33e6d9bccfabdf45dc5ddf24c">numPointsBuffer</a>, <a class="el" href="OperatorKernels_8H.html#afc6f027cdb36bf6d86e573c2083e555b">opDir</a>, <a class="el" href="OperatorKernels_8H.html#a3ebb77d78da88e132f012ab6788ff123">numStencils</a>, <a class="el" href="OperatorKernels_8H.html#ad36f7e6638c24dc8cce030ebb48e32a4">stencilSizes</a>, <a class="el" href="OperatorKernels_8H.html#ab81c9b92fc99d6a20e08f1ad1c9630b0">stencilStarts</a>, numStencilValues, <a class="el" href="OperatorKernels_8H.html#a71782584f6f521c3d69ed8a53fbbbd59">stencilWeights</a>, <a class="el" href="OperatorKernels_8H.html#aace4e878476c6638c99ce2be58848e52">stencilOffsets</a>, numPointsStencil, numPointsApply, stencilPoints, <a class="el" href="SimpleKernels_8H.html#aca4ab6143606c908fb1a7de286ddddae">U</a>, dU)</td></tr>
<tr class="memdesc:a526cfaf4061ff38e8b9cba873cb1392c"><td class="mdescLeft">&#160;</td><td class="mdescRight">applyoperatorblobs applies an operator by applying each stencil in turn to all the points to which it applies  <a href="#a526cfaf4061ff38e8b9cba873cb1392c">More...</a><br /></td></tr>
<tr class="separator:a526cfaf4061ff38e8b9cba873cb1392c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac15b9cb3b0cb47f9a68c536b4f096941"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceoperators.html#ac15b9cb3b0cb47f9a68c536b4f096941">applysinglestencil</a> (<a class="el" href="SATKernels_8H.html#a680185db8546de161968dabace9e94f1">numDim</a>, <a class="el" href="SATKernels_8H.html#a338d2e6b5802f9ba652d355df0b1a04b">dimSizes</a>, <a class="el" href="SimpleKernels_8H.html#abb39988074870d597c8d1cfcf61514ee">numComponents</a>, <a class="el" href="WENOKernels_8H.html#a86c25ff33e6d9bccfabdf45dc5ddf24c">numPointsBuffer</a>, <a class="el" href="OperatorKernels_8H.html#afc6f027cdb36bf6d86e573c2083e555b">opDir</a>, numPointsApply, applyPoints, stencilSize, <a class="el" href="OperatorKernels_8H.html#a71782584f6f521c3d69ed8a53fbbbd59">stencilWeights</a>, <a class="el" href="OperatorKernels_8H.html#aace4e878476c6638c99ce2be58848e52">stencilOffsets</a>, <a class="el" href="SimpleKernels_8H.html#aca4ab6143606c908fb1a7de286ddddae">U</a>, dU)</td></tr>
<tr class="memdesc:ac15b9cb3b0cb47f9a68c536b4f096941"><td class="mdescLeft">&#160;</td><td class="mdescRight">applysinglestencil applies an operator by applying a given stencil to the specified points  <a href="#ac15b9cb3b0cb47f9a68c536b4f096941">More...</a><br /></td></tr>
<tr class="separator:ac15b9cb3b0cb47f9a68c536b4f096941"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function/Subroutine Documentation</h2>
<a id="aee961d7de8b2c319cd0270f5ae735de7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aee961d7de8b2c319cd0270f5ae735de7">&sect;&nbsp;</a></span>applyoperator()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine operators::applyoperator </td>
          <td>(</td>
          <td class="paramtype">integer(kind=4), intent(in)&#160;</td>
          <td class="paramname"><em>numDim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(kind=8), dimension(numdim), intent(in)&#160;</td>
          <td class="paramname"><em>dimSizes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(kind=4), intent(in)&#160;</td>
          <td class="paramname"><em>numComponents</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(kind=8), intent(in)&#160;</td>
          <td class="paramname"><em>numPoints</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(kind=4), intent(in)&#160;</td>
          <td class="paramname"><em>opDir</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(kind=8), dimension(2*numdim), intent(in)&#160;</td>
          <td class="paramname"><em>opInterval</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(kind=4), intent(in)&#160;</td>
          <td class="paramname"><em>numStencils</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(kind=4), dimension(numstencils), intent(in)&#160;</td>
          <td class="paramname"><em>stencilSizes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(kind=4), dimension(numstencils), intent(in)&#160;</td>
          <td class="paramname"><em>stencilStarts</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(kind=4), intent(in)&#160;</td>
          <td class="paramname"><em>numValues</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=8), dimension(numvalues), intent(in)&#160;</td>
          <td class="paramname"><em>stencilWeights</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(kind=4), dimension(numvalues), intent(in)&#160;</td>
          <td class="paramname"><em>stencilOffsets</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(kind=4), dimension(numpoints), intent(in)&#160;</td>
          <td class="paramname"><em>stencilID</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=8), dimension(numpoints*numcomponents), intent(in), target&#160;</td>
          <td class="paramname"><em>U</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=8), dimension(numpoints*numcomponents), intent(out), target&#160;</td>
          <td class="paramname"><em>dU</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>applyoperator applies an operator specified as a stencil set to the provided state data </p>
<p>applyoperator is a brute-force method of applying a set of stencils to a given data buffer. The The stencilset and operand are given as flat, primitive arrays, with supporting data to indicate the size of the data structures. An additional <em>stencil connectivity</em> is given which indicates which stencil (i.e. which stencil from the stencil set) to apply to each point. This brute-force method simply loops through all points, and applies the stencil indicated by the resolved stencil connectivity to each point. </p><div class="image">
<img src="ApplyOperatorBrute.png" alt="ApplyOperatorBrute.png" width="256"/>
<div class="caption">
applyoperator brute-force method cartoon</div></div>
 <dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">numDim</td><td>indicates the number of dimensions for the input data (dimSizes,opInterval) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">dimSizes</td><td>indicates the number of points in each dimension [Nx Ny Nz] </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">numComponents</td><td>indicates the number of components in the input/output data (U,dU) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">numPoints</td><td>indicates the total number of points <a href="needed for C/Fortran interface">Nx*Ny*Nz</a> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">opDir</td><td>indicates in which direction the operator will be applied [X=1 | Y=2 | Z=3] </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">opInterval</td><td>array of size (2*numDim) which indicates the index interval on which to operate [xStart,xEnd,yStart,yEnd...] </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">numStencils</td><td>indicates the number of stencils in the input stencilset </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">stencilSizes</td><td>array of size (numStencils) which indicates the number of weight values for each stencil </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">stencilStarts</td><td>array of size (numStencils) which indicates the starting index into (stencilWeights and stencilOffsets) for each stencil </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">numValues</td><td>total number of stencil weight values (numStencils[1]*numStencils[2]*...numStecils[numStencils]) (req'd for C/Fort interface) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">stencilWeights</td><td>array of size (numValues) which contains the weights for all the stencils in the stencilset </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">stencilOffsets</td><td>array of size (numValues) which indicates the offsets from the <em>considered</em> point to the point where each weight is applied </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">stencilID</td><td>array of size (numPoints) which indicates the stencil ID for each point </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">U</td><td>the data on which to operate </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">dU</td><td>where to stuff the result </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="Operators_8f90_source.html#l00037">37</a> of file <a class="el" href="Operators_8f90_source.html">Operators.f90</a>.</p>

<p>Referenced by <a class="el" href="Grid_8f90_source.html#l00057">grid::computecurvilineargridmetrics()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><!-- SVG 0 -->
</div>
</div>

</div>
</div>
<a id="a526cfaf4061ff38e8b9cba873cb1392c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a526cfaf4061ff38e8b9cba873cb1392c">&sect;&nbsp;</a></span>applyoperatorblobs()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine operators::applyoperatorblobs </td>
          <td>(</td>
          <td class="paramtype">integer(kind=4), intent(in)&#160;</td>
          <td class="paramname"><em>numDim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(kind=8), dimension(numdim), intent(in)&#160;</td>
          <td class="paramname"><em>dimSizes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(kind=4), intent(in)&#160;</td>
          <td class="paramname"><em>numComponents</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(kind=8), intent(in)&#160;</td>
          <td class="paramname"><em>numPointsBuffer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(kind=4), intent(in)&#160;</td>
          <td class="paramname"><em>opDir</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(kind=4), intent(in)&#160;</td>
          <td class="paramname"><em>numStencils</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(kind=4), dimension(numstencils), intent(in)&#160;</td>
          <td class="paramname"><em>stencilSizes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(kind=4), dimension(numstencils), intent(in)&#160;</td>
          <td class="paramname"><em>stencilStarts</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(kind=4), intent(in)&#160;</td>
          <td class="paramname"><em>numStencilValues</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=8), dimension(numstencilvalues), intent(in)&#160;</td>
          <td class="paramname"><em>stencilWeights</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(kind=4), dimension(numstencilvalues), intent(in)&#160;</td>
          <td class="paramname"><em>stencilOffsets</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(kind=8), dimension(numstencils), intent(in)&#160;</td>
          <td class="paramname"><em>numPointsStencil</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(kind=8), intent(in)&#160;</td>
          <td class="paramname"><em>numPointsApply</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(kind=8), dimension(numpointsapply), intent(in)&#160;</td>
          <td class="paramname"><em>stencilPoints</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=8), dimension(numpointsbuffer), intent(in)&#160;</td>
          <td class="paramname"><em>U</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=8), dimension(numpointsbuffer), intent(out)&#160;</td>
          <td class="paramname"><em>dU</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>applyoperatorblobs applies an operator by applying each stencil in turn to all the points to which it applies </p>
<p>applyoperatorblobs is a <em>blobbed</em> method of applying a set of stencils to a given data buffer. The stencilset and operand are given as flat, primitive arrays, with supporting data to indicate the size of the data structures. An additional <em>dual stencil connectivity</em> is given which indicates which points to apply to a given stencil. This blobbed method loops through all the stencils, and applies each stencil to the set of pionts indicated by the resolved dual stencil connectivity for each stencil. </p><div class="image">
<img src="ApplyOperatorBlobs.png" alt="ApplyOperatorBlobs.png" width="256"/>
<div class="caption">
applyoperatorBLOBS - blobbed method cartoon</div></div>
 <dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">numDim</td><td>indicates the number of dimensions for the input data (dimSizes,opInterval) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">dimSizes</td><td>indicates the number of points in each dimension [Nx Ny Nz] </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">numComponents</td><td>indicates the number of components in the input/output data (U,dU) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">numPointsBuffer</td><td>indicates the total number of points <a href="needed for C/Fortran interface">Nx*Ny*Nz</a> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">opDir</td><td>indicates in which direction the operator will be applied [X=1 | Y=2 | Z=3] </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">numStencils</td><td>indicates the number of stencils in the input stencilset </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">stencilSizes</td><td>array of size (numStencils) which indicates the number of weight values for each stencil </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">stencilStarts</td><td>array of size (numStencils) which indicates the starting index into (stencilWeights and stencilOffsets) for each stencil </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">numStencilValues</td><td>total number of stencil weight values (numStencils[1]*numStencils[2]*...numStecils[numStencils]) (req'd for C/Fort interface) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">stencilWeights</td><td>array of size (numValues) which contains the weights for all the stencils in the stencilset </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">stencilOffsets</td><td>array of size (numValues) which indicates the offsets from the <em>considered</em> point to the point where each weight is applied </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">numPointsStencil</td><td>array of size (numStencils) which indicates how many points to apply each stencil </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">numPointsApply</td><td>total number of points in the stencilPoints array (needed for C/Fortran interface) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">stencilPoints</td><td>array of size (numPointsStencil(1)*numPointsStencil(2)*...numPointsStencil(numStencils)) indicating the points to which each stencil applies </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">U</td><td>the data on which to operate </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">dU</td><td>where to stuff the result </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="Operators_8f90_source.html#l00313">313</a> of file <a class="el" href="Operators_8f90_source.html">Operators.f90</a>.</p>

<p>References <a class="el" href="Operators_8f90_source.html#l00383">applysinglestencil()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><!-- SVG 1 -->
</div>
</div>

</div>
</div>
<a id="ad6db84fac96d0301e9802d7504d4b927"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad6db84fac96d0301e9802d7504d4b927">&sect;&nbsp;</a></span>applyoperatorv()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine operators::applyoperatorv </td>
          <td>(</td>
          <td class="paramtype">integer(kind=4), intent(in)&#160;</td>
          <td class="paramname"><em>numDim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(kind=8), dimension(numdim), intent(in)&#160;</td>
          <td class="paramname"><em>dimSizes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(kind=4), intent(in)&#160;</td>
          <td class="paramname"><em>numComponents</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(kind=8), intent(in)&#160;</td>
          <td class="paramname"><em>numPoints</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(kind=4), intent(in)&#160;</td>
          <td class="paramname"><em>opDir</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(kind=8), dimension(2*numdim), intent(in)&#160;</td>
          <td class="paramname"><em>opInterval</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(kind=4), intent(in)&#160;</td>
          <td class="paramname"><em>numStencils</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(kind=4), dimension(numstencils), intent(in)&#160;</td>
          <td class="paramname"><em>stencilSizes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(kind=4), dimension(numstencils), intent(in)&#160;</td>
          <td class="paramname"><em>stencilStarts</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(kind=4), intent(in)&#160;</td>
          <td class="paramname"><em>numValues</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=8), dimension(numvalues), intent(in)&#160;</td>
          <td class="paramname"><em>stencilWeights</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(kind=4), dimension(numvalues), intent(in)&#160;</td>
          <td class="paramname"><em>stencilOffsets</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(kind=4), dimension(numpoints), intent(in)&#160;</td>
          <td class="paramname"><em>stencilID</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=8), dimension(numpoints*numcomponents), intent(in), target&#160;</td>
          <td class="paramname"><em>U</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=8), dimension(numpoints*numcomponents), intent(out), target&#160;</td>
          <td class="paramname"><em>dU</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>applyoperator applies an operator specified as a stencil set to the provided state data </p>
<p>applyoperator is a brute-force method of applying a set of stencils to a given data buffer. The The stencilset and operand are given as flat, primitive arrays, with supporting data to indicate the size of the data structures. An additional <em>stencil connectivity</em> is given which indicates which stencil (i.e. which stencil from the stencil set) to apply to each point. This brute-force method simply loops through all points, and applies the stencil indicated by the resolved stencil connectivity to each point. </p><div class="image">
<img src="ApplyOperatorBrute.png" alt="ApplyOperatorBrute.png" width="256"/>
<div class="caption">
applyoperator brute-force method cartoon</div></div>
 <dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">numDim</td><td>indicates the number of dimensions for the input data (dimSizes,opInterval) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">dimSizes</td><td>indicates the number of points in each dimension [Nx Ny Nz] </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">numComponents</td><td>indicates the number of components in the input/output data (U,dU) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">numPoints</td><td>indicates the total number of points <a href="needed for C/Fortran interface">Nx*Ny*Nz</a> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">opDir</td><td>indicates in which direction the operator will be applied [X=1 | Y=2 | Z=3] </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">opInterval</td><td>array of size (2*numDim) which indicates the index interval on which to operate [xStart,xEnd,yStart,yEnd...] </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">numStencils</td><td>indicates the number of stencils in the input stencilset </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">stencilSizes</td><td>array of size (numStencils) which indicates the number of weight values for each stencil </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">stencilStarts</td><td>array of size (numStencils) which indicates the starting index into (stencilWeights and stencilOffsets) for each stencil </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">numValues</td><td>total number of stencil weight values (numStencils[1]*numStencils[2]*...numStecils[numStencils]) (req'd for C/Fort interface) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">stencilWeights</td><td>array of size (numValues) which contains the weights for all the stencils in the stencilset </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">stencilOffsets</td><td>array of size (numValues) which indicates the offsets from the <em>considered</em> point to the point where each weight is applied </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">stencilID</td><td>array of size (numPoints) which indicates the stencil ID for each point </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">U</td><td>the data on which to operate </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">dU</td><td>where to stuff the result </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="Operators_8f90_source.html#l00175">175</a> of file <a class="el" href="Operators_8f90_source.html">Operators.f90</a>.</p>

</div>
</div>
<a id="ac15b9cb3b0cb47f9a68c536b4f096941"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac15b9cb3b0cb47f9a68c536b4f096941">&sect;&nbsp;</a></span>applysinglestencil()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine operators::applysinglestencil </td>
          <td>(</td>
          <td class="paramtype">integer(kind=4), intent(in)&#160;</td>
          <td class="paramname"><em>numDim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(kind=8), dimension(numdim), intent(in)&#160;</td>
          <td class="paramname"><em>dimSizes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(kind=4), intent(in)&#160;</td>
          <td class="paramname"><em>numComponents</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(kind=8), intent(in)&#160;</td>
          <td class="paramname"><em>numPointsBuffer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(kind=4), intent(in)&#160;</td>
          <td class="paramname"><em>opDir</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(kind=8), intent(in)&#160;</td>
          <td class="paramname"><em>numPointsApply</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(kind=8), dimension(numpointsapply), intent(in)&#160;</td>
          <td class="paramname"><em>applyPoints</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(kind=4), intent(in)&#160;</td>
          <td class="paramname"><em>stencilSize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=8), dimension(stencilsize), intent(in)&#160;</td>
          <td class="paramname"><em>stencilWeights</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(kind=4), dimension(stencilsize), intent(in)&#160;</td>
          <td class="paramname"><em>stencilOffsets</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=8), dimension(numpointsbuffer), intent(in)&#160;</td>
          <td class="paramname"><em>U</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=8), dimension(numpointsbuffer), intent(out)&#160;</td>
          <td class="paramname"><em>dU</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>applysinglestencil applies an operator by applying a given stencil to the specified points </p>
<p>applysinglestencil is a single-stencil method which operates on the given points The stencil and operand are given as flat, primitive arrays, with supporting data to indicate the size of the data structures. An additional array of points is given which indicates the points on which to operate. This single-stencil method loops through all the specified points and applies the stencil to each. </p><div class="image">
<img src="ApplyOperatorBlobs.png" alt="ApplyOperatorBlobs.png" width="256"/>
<div class="caption">
applyoperatorBLOBS - blobbed method cartoon</div></div>
 <dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">numDim</td><td>indicates the number of dimensions for the input data (dimSizes,opInterval) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">dimSizes</td><td>indicates the number of points in each dimension [Nx Ny Nz] </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">numComponents</td><td>indicates the number of components in the input/output data (U,dU) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">numPointsBuffer</td><td>indicates the total number of points <a href="needed for C/Fortran interface">Nx*Ny*Nz</a> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">opDir</td><td>indicates in which direction the operator will be applied [X=1 | Y=2 | Z=3] </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">numPointsApply</td><td>total number of points in the stencilPoints array (needed for C/Fortran interface) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">applyPoints</td><td>array of size (numPointsApply) indicating the points to which to apply the stencil </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">stencilSize</td><td>number of stencil weights </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">stencilWeights</td><td>array of size (stencilSize) which contains the weights for all the stencils in the stencilset </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">stencilOffsets</td><td>array of size (stencilSize) which indicates the offsets from the <em>considered</em> point to the point where each weight is applied </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">U</td><td>the data on which to operate </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">dU</td><td>where to stuff the result </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="Operators_8f90_source.html#l00383">383</a> of file <a class="el" href="Operators_8f90_source.html">Operators.f90</a>.</p>

<p>Referenced by <a class="el" href="Operators_8f90_source.html#l00313">applyoperatorblobs()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><!-- SVG 2 -->
</div>
</div>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespaceoperators.html">operators</a></li>
    <li class="footer">Generated on Fri Apr 10 2020 12:24:30 for JustKernels by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.12 </li>
  </ul>
</div>
</body>
</html>
